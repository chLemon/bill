# 1. 设计

## 1.1. 整体流程

1. 读取数据
2. 标记数据、预处理
3. 分组/统计
4. 导出结果

## 1.2. 模块划分

1. 读取
2. 账单对象
3. 导出
    1. 如果要有 sheet，那么就只能导出为 excel，而不是简单的 csv，需要使用 pandas
4. 统计分析能力
5. 标记能力
6. 退款映射能力，银行卡交易和别的支付 app 的映射能力

### 1.2.1. 账单读取

#### 1.2.1.1. 支付工具

微信
支付宝

#### 1.2.1.2. 银行卡

浦发银行信用卡
招商银行
工商银行
中国银行

#### 1.2.1.3. 购物网站

淘宝
京东
美团
大众点评

### 1.2.2. 账单类设计

目前不同 APP 能获取到的字段信息是不一样的，有的很多，有的很少

基础字段：

-   交易时间
-   交易对方
-   商品
-   收/支
-   金额
-   优惠/退款记录
-   关联记录（主要是如微信支付对应的银行支付记录）
-   交易单号（订单的唯一标识，如果没有需要生成一个）

#### 1.2.2.1. 微信

| 字段     | 示例                |
| -------- | ------------------- |
| 交易时间 | 2023-04-01 00:00:00 |
| 交易类型 | 商户消费            |
| 交易对方 | 7-11(SEB)           |
| 商品     | 7-ELEVEn xxx 店消费 |
| 收/支    | 支出                |
| 金额(元) | ¥6.00               |
| 支付方式 | 某银行卡            |
| 当前状态 | 支付成功            |
| 交易单号 | xxxx                |
| 商户单号 | xxxx                |
| 备注     | /                   |

#### 1.2.2.2. 支付宝

| 字段        | 示例 1                     | 示例 2              |
| ----------- | -------------------------- | ------------------- |
| 交易时间    | 2023-04-01 00:00:00        | 2023-04-01 00:00:00 |
| 交易分类    | 投资理财                   | 餐饮美食            |
| 交易对方    | 景顺长城货币 A             | 沙县                |
| 对方账号    | /                          | /                   |
| 商品说明    | 余额宝-2023.04.01-收益发放 | 沙县                |
| 收/支       | 不计收支                   | 支出                |
| 金额        | 0.01                       | 10.00               |
| 收/付款方式 | 余额宝                     | 某银行卡            |
| 交易状态    | 交易成功                   | 交易成功            |
| 交易订单号  | xxxx                       | xxxx                |
| 商家订单号  |                            | xxxx                |
| 备注        |                            |                     |

#### 1.2.2.3. 浦发银行信用卡

| 字段       | 示例            |
| ---------- | --------------- |
| 交易日期   | 20230401        |
| 记账日期   | 20230401        |
| 交易摘要   | 财付通-兰州拉面 |
| 卡号末四位 | 1234            |
| 交易金额   | ￥ 20.00        |

#### 1.2.2.4. 招商银行

| 字段     | 示例       |
| -------- | ---------- |
| 记账日期 | 2023-04-01 |
| 货币     | CNY        |
| 交易金额 | -25        |
| 联机余额 | 100.00     |
| 交易摘要 | 一网通支付 |
| 对手信息 | 黄焖鸡米饭 |

#### 1.2.2.5. 工商银行

| 字段          | 示例                         |
| ------------- | ---------------------------- |
| 交易日期      | 23-04-01 00:00:00            |
| 账号          | xxxx                         |
| 储种          | 活期                         |
| 序号          | xxxx                         |
| 币种          | 人民币                       |
| 钞汇          | 钞                           |
| 摘要          | 消费                         |
| 地区          | xxxx                         |
| 收入/支出金额 | -20.00                       |
| 余额          | 100.00                       |
| 对方户名      | 深圳市财付通支付科技有限公司 |
| 对方账号      | xxxx                         |
| 渠道          | 快捷支付                     |

#### 1.2.2.6. 中国银行

| 字段          | 示例                |
| ------------- | ------------------- |
| 记账日期      | 2023-04-01          |
| 记账时间      | 00:00:00            |
| 币别          | 人民币              |
| 金额          | -10.00              |
| 余额          | 100.00              |
| 交易名称      | 网上快捷支付        |
| 渠道          | 银企对接            |
| 网点名称      | ------------------- |
| 附言          | 财付通-饿了么       |
| 对方账户名    | 财付通-饿了么       |
| 对方卡号/账号 | xxxx                |
| 对方开户行    | ------------------  |
